<!DOCTYPE html>
<html lang="en">

<head>
  <meta property="og:title" content="365Connect Community">
  <meta property="og:description"
    content="365Connect is a community dedicated to promoting and advancing the adoption of Microsoft D365 and Power Platform technologies. Our primary goal is to foster a supportive environment where individuals can learn, teach, and collaborate on all things related to these powerful tools. Whether you're an experienced user or just starting out, we welcome members from any part of the globe to join us in our mission to promote and develop this community.">
  <meta property="og:image" content="https://365connectcommunity.github.io/preview.png">
  <meta property="og:url" content="https://365connectcommunity.github.io/">

  <!---->

  <link rel="icon" type="image/x-icon" href="./favicon.ico">
  <!-- <meta charset="utf-8"> -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!--<meta name="description"
    content="365Connect is a community dedicated to promoting and advancing the adoption of Microsoft D365 and Power Platform technologies. Our primary goal is to foster a supportive environment where individuals can learn, teach, and collaborate on all things related to these powerful tools. Whether you're an experienced user or just starting out, we welcome members from any part of the globe to join us in our mission to promote and develop this community.">
  <meta name="author" content="Shaheer Ahmad">
  <meta property="og:image" content="URL to your page's image thumbnail"> -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700,800,900" rel="stylesheet">

  <title>Sign-In | 365Connect Community</title>

  <link rel="stylesheet" href="styles.css">
  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Additional CSS Files -->
  <link rel="stylesheet" href="assets/css/fontawesome.css">
  <link rel="stylesheet" href="assets/css/templatemo-grad-school.css">
  <link rel="stylesheet" href="assets/css/owl.css">
  <link rel="stylesheet" href="assets/css/lightbox.css">
  <!--
    
TemplateMo 557 Grad School

https://templatemo.com/tm-557-grad-school

-->
</head>
<style>
  body{
    height: auto;
  }
  html{
    height: 100vh;
  }
</style>

<body>
  <h1 style="display: none;">365Connect Community</h1>

  <div class="loading" id="loading">Loading&#8230;</div>
  <!--header-->
  <header class="main-header clearfix" role="header">
    <div class="logo">
      <img id="header-logo" style="height: 50px; margin-right: 20px;" src="./favicon.ico">
      <a href="./index.html" style=" font-size: 29px !important;"><em></em><span style="color: #feb70c;">3</span><span
          style="color: #5ea904;">6</span><span style="color: #04a0ed;">5</span><span
          style="color: white;">C</span><span style="text-transform: lowercase;">onnect</span></a><!--#ce392c;-->
    </div>
    <a href="#menu" class="menu-link"><i class="fa fa-bars"></i></a>
    <nav id="menu" class="main-nav" role="navigation">
      <ul class="main-menu">
        <li><a href="./index.html" class="external">Home</a></li>
        <li class="has-submenu"><a href="#">Our Family</a>
          <ul class="sub-menu">
            <li><a href="./team-members.html" class="external">Contributors</a></li>
            <li><a href="./community-members.html" class="external">Members</a></li>
            <li><a href="./become-contributor.html" class="external">Become Contributor</a></li>
            <li><a href="./signup.html" class="external">Become Member</a></li>
          </ul>
        </li>
        <li class="has-submenu"><a href="#">Resources</a>
          <ul class="sub-menu">
            <li><a href="./events.html" class="external">Events</a></li>
            <li><a href="./blog.html" class="external">Blogs</a></li>
            <li><a href="./courses.html" class="external">Courses</a></li>
            <li><a href="./sample-soltutions.html" class="external">Sample Solutions</a></li>
          </ul>
        </li>
        <li class="has-submenu"><a href="#">Contact Us</a>
          <ul class="sub-menu">
            <li><a href="./support.html" class="external">Get Support</a></li>
            <li><a href="./index.html" class="external">Seek Guidance</a></li>
            <li><a href="./our-socials.html" class="external">Our Socials</a></li>
          </ul>
        </li>
        <li><a href="https://365connectcommunity.azurewebsites.net/" class="external" id="cartimg"></a></li>
      </ul>
    </nav>
  </header>

  
  <section class="section coming-soon" data-section="section3">
    <div class="container">
      <div class="row">
        <div class="col-md-7 col-xs-12">
          <br><br><br>
          <div class="continer centerIt">
            <div><br>
              <h4>Sign-In to your free account and <em>get immediate</em> access to your registrations and certifications.</h4>
              <!--
              <div class="counter">

                <div class="days">
                  <div class="value">00</div>
                  <span>Days</span>
                </div>

                <div class="hours">
                  <div class="value">00</div>
                  <span>Hours</span>
                </div>

                <div class="minutes">
                  <div class="value">00</div>
                  <span>Minutes</span>
                </div>

                <div class="seconds">
                  <div class="value">00</div>
                  <span>Seconds</span>
                </div>

              </div>
              -->
            </div>
          </div>
        </div>
        <div class="col-md-5">
          <div class="right-content">
            <div class="top-content">
              <h6>Sign-In to your free account and <em>get immediate</em> access to your registrations and certifications.</h6>
            </div>
            <form id="contact" action="" method="get">
              <div class="row">
                
                <div class="col-md-12">
                  <fieldset>
                    <input name="email" type="text" class="form-control" id="email" placeholder="Your Email"
                      required="">
                  </fieldset>
                </div>
                <br><br>
                <div class="col-md-12">
                  <fieldset>
                    <p class="btn" style="background-color: orange !important;" onclick="submit()"
                      id="register-button">Continue with Email</p>
                  </fieldset>
                  <p>Don't have an account? <a href="./signup.html">Sign-Up Here</a></p>
                  <div class="message" id="message1">
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <p><i class="fa fa-copyright"></i> Copyright 2023 by 365Connect Community

            | Design: <a href="https://www.linkedin.com/in/shaheer-ahmad-ch" rel="sponsored" target="_parent">Shaheer
              Ahmad</a></p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <script src="assets/js/isotope.min.js"></script>
  <script src="assets/js/owl-carousel.js"></script>
  <script src="assets/js/lightbox.js"></script>
  <script src="assets/js/tabs.js"></script>
  <script src="assets/js/video.js"></script>
  <script src="assets/js/slick-slider.js"></script>
  <script src="assets/js/custom.js"></script>
  <script>
    if (localStorage.getItem("name") == null || localStorage.getItem("email") == null || localStorage.getItem("email") == 'null' || localStorage.getItem("name") == 'null' || localStorage.getItem("email") == '' || localStorage.getItem("name") == '') {
        console.log("not signed in")
    }
    else {
        let url = "./my-profile.html";
        window.location.href = url;
    }
    const email = localStorage.getItem("email");
    const fullname = localStorage.getItem("name");


    ///////
    function showError(alert, alertType) {
            var message = document.getElementById("message1");
            var messagetext = document.createElement("div");
            messagetext.classList.add("alert")
            messagetext.classList.add("alert-" + alertType)
            messagetext.textContent = alert;
            message.appendChild(messagetext);
        }

    if (screen.height > screen.width) {
      document.getElementById("header-logo").hidden = true;
    }

    ///////////////
    // Menu data structure
    var signedIn = localStorage.getItem("name") == null || localStorage.getItem("email") == null || localStorage.getItem("email") == 'null' || localStorage.getItem("name") == 'null' || localStorage.getItem("email") == '' || localStorage.getItem("name") == '' || localStorage.getItem("email") == undefined || localStorage.getItem("name") == undefined;
    function generateProfileSubMenu() {
      if (signedIn) {
        return `
    <li class="has-submenu active">
      <img id= "myprofilepic" src="./assets/images/icons8-account-64.png" style="width:45px;height:45px;border-radius:200px;border:0px solid orange;">
      <ul class="sub-menu">
        <li><a href="./login.html" class="external">Sign In</a></li>
        <li><a href="./signup.html" class="external">Sign Up</a></li>
      </ul>
    </li>
  `;
      }
      else {
        return `
    <li class="has-submenu active">
      <img id= "myprofilepic" src="data:image/png;base64,${localStorage.getItem("image")}" style="width:45px;height:45px;border-radius:200px;border:2px solid orange;">
      <ul class="sub-menu">
        <li><a href="./login.html" class="external">${localStorage.firstname}</a></li>
        <li><a href="./login.html" class="external">My Registrations</a></li>
        <li><a href="./my-certificates.html" class="external">My Certificates</a></li>
        <li><a href="./index.html" class="external" id="logout">Sign Out</a></li>
      </ul>
    </li>
  `;
      }
    }
    

        // Add a click event listener
        

    // Find the parent ul element with the class "main-menu"
    const mainMenu = document.querySelector('.main-menu');

    // Append the "Profile" submenu HTML to the mainMenu
    mainMenu.insertAdjacentHTML('beforeend', generateProfileSubMenu());
    const myLink = document.getElementById('logout');
    if(document.getElementById('logout'))
    myLink.addEventListener('click', function (event) {
            // Prevent the default behavior (e.g., navigating to the href URL)
            event.preventDefault();

            // You can also perform other actions here
            localStorage.setItem("name", null);
      localStorage.setItem("email", null);
      localStorage.setItem("image", null);
      window.location.href = './index.html';
            
        });
    /////
    document.getElementById("loading").style.display = "none";
    if (screen.height > screen.width) {
      document.getElementById("header-logo").hidden = true;
    }



    function submit() {
        
      while (document.querySelector(".alert")) {
        document.querySelector('.alert').parentElement.removeChild(document.querySelector(".alert"));
      }
        if (document.getElementById("email").value == '')
            showError("Email is required","danger")
        if (document.getElementById("email").value != '') {
            document.getElementById("loading").style.display = "block";
            var myHeaders = new Headers();
            myHeaders.append("email", document.getElementById("email").value);

            var requestOptions = {
                method: 'GET',
                headers: myHeaders,
                redirect: 'follow'
            };

            fetch("https://prod-43.westeurope.logic.azure.com:443/workflows/6925f68ce8a842d8893aa7a606a6c8f4/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=-rUEpqm-E6NB2lrmxYrhX-CEj6IKu_-asLVQ_Qkcv4I", requestOptions)
                .then(response => {
                    if (response.status === 200) {
                        // Parse the response body as JSON
                        return response.json();
                    } else {
                        // Handle other response statuses or errors here
                        showError("Account not found","danger");
                        document.getElementById("loading").style.display = "none";
                        return null;
                    }
                })
                .then(data => {
                    // Check if data is not null
                    if (data !== null) {
                        // Extract the necessary information from the data
                        const email = data.emailaddress1;
                        const name = data.fullname;
                        const firstname = data.firstname;
                        const lastname = data.lastname;
                        const image = data.entityimage;
                        console.log(image)

                        // Construct the URL with query parameters
                        const url = `./login-varify.html`;
                        localStorage.setItem("email1", email);
                        localStorage.setItem("name1",name);
                        localStorage.setItem("firstname1",firstname);
                        localStorage.setItem("lastname1",lastname);
                        localStorage.setItem("image1",image);
                        // Navigate to the desired URL
                        window.location.href = url;
                    }
                })
                .catch(error => {
                    showError("Account not found","dager");
                    document.getElementById("loading").style.display = "none";
                });

            }
            //window.location.replace("./registrations.html?email="+document.getElementById("email").value)
        }
        if (screen.height > screen.width) {
      document.getElementById("myprofilepic").hidden = true;
    }
    if (localStorage.getItem("image") == '' || localStorage.getItem("image") == null || localStorage.getItem("image") == 'null' || localStorage.getItem("image") == 'undefined') {
      document.getElementById("myprofilepic").src = './assets/images/icons8-account-64.png';
    }
  </script>
</body>

</html>
